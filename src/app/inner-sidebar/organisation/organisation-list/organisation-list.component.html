<div class="main-section animated fadeIn">
  <div class="inner-section">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <!-- <div class="header-box">
            <h4>List Consortium Member</h4>
            <button routerLink="/inner-sidebar/consortium-member/create" routerLinkActive="router-link-active"
              class="btn btn-primary">Create
              Consortium Member</button>
            <button class="btn btn-primary">Import Consortium Member</button>
          </div> -->
          <div class="header">
            <h4>List Consortium Member</h4>
            <!-- <button (click)="openImportModal()" class="btn btn-primary btn-import">Import</button> -->
            <button
              routerLink="/inner-sidebar/consortium-member/create"
              routerLinkActive="router-link-active"
              class="btn btn-primary"
            >
              Create Consortium Member
            </button>
          </div>
        </div>
        <div class="col-12">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Name</th>
                  <th scope="col">MSP</th>
                  <th scope="col">CA</th>
                  <th scope="col">TLS CA</th>
                  <th scope="col">Type</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let data of records
                      | paginate: { itemsPerPage: 10, currentPage: p }
                  "
                >
                  <td>{{ data.name ? data.name : "" }}</td>
                  <td>{{ data.mspId ? data.mspId : "" }}</td>
                  <td>{{ data.caId ? data.ca.name : "N/A" }}</td>
                  <td>{{ data.tlsCaId ? data.tlsCa.name : "N/A" }}</td>

                  <td *ngIf="data && data.type === 0">Peer</td>
                  <td *ngIf="data && data.type === 1">Orderer</td>
                  <td *ngIf="data && data.type === 2">Imported</td>

                  <td>
                    <i
                      [routerLink]="['view', data._id]"
                      class="far fa-eye"
                      placement="top"
                      ngbTooltip="View"
                      tooltipClass="tooltip-custom-class"
                    ></i>
                    <!-- <i [routerLink]="['edit', data._id]" class="far fa-edit" placement="top" ngbTooltip="Edit"
                    tooltipClass="tooltip-custom-class"></i> -->

                    <i
                      *ngIf="data && (data.type === 0 || data.type === 1)"
                      (click)="dynamicDownloadJson(data._id)"
                      class="fas fa-file-export"
                      placement="top"
                      ngbTooltip="Export"
                      tooltipClass="tooltip-custom-class"
                    ></i>

                    <i
                      class="far fa-trash-alt"
                      placement="top"
                      ngbTooltip="Delete"
                      tooltipClass="tooltip-custom-class"
                      (click)="deleteModelPopUp()"
                      (click)="deleteId = data._id"
                    ></i>
                    <span>|</span>
                  </td>
                </tr>
                <tr *ngIf="!records.length">
                  <td class="text-center" colspan="6">No Data Found.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="footer">
        <!--  <pagination-controls (pageChange)="p = $event"></pagination-controls> -->

        <pagination-template
          class="pagination"
          #pagination="paginationApi"
          (pageChange)="p = $event"
        >
          <ul *ngIf="records.length" class="pagination">
            <li class="paginate_button page-item">
              <a (click)="pagination.setCurrent(1)" class="page-link"
                >&laquo;</a
              >
            </li>

            <li
              class="paginate_button page-item previous"
              [class.disabled]="pagination.isFirstPage()"
            >
              <a
                (click)="!pagination.isFirstPage() && pagination.previous()"
                class="page-link"
                >&lt;</a
              >
            </li>

            <li
              *ngFor="let page of pagination.pages"
              [class.active]="pagination.getCurrent() === page.value"
              class="paginate_button page-item"
            >
              <a
                (click)="
                  pagination.getCurrent() !== page.value &&
                    pagination.setCurrent(page.value)
                "
                class="page-link"
                >{{ page.label }}</a
              >
            </li>

            <li
              class="paginate_button page-item next"
              [class.disabled]="pagination.isLastPage()"
            >
              <a
                (click)="!pagination.isLastPage() && pagination.next()"
                class="page-link"
                >&gt;</a
              >
            </li>

            <li class="paginate_button page-item">
              <a
                (click)="pagination.setCurrent(pagination.getLastPage())"
                class="page-link"
                >&raquo;</a
              >
            </li>
          </ul>
        </pagination-template>
      </div>
    </div>
  </div>
  <ng-template #content let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="modal-basic-title">Invalid Access</h5>
    </div>
    <div class="modal-body">
      <div class="parent-box">
        <div class="below-header">
          <p>Please Select network First</p>
        </div>
        <div class="modal-footer">
          <button (click)="goToNetworkList()" class="btn btn-primary">
            Ok
          </button>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #deleteModel let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="modal-basic-title">
        Delete Consortium Member
      </h5>
    </div>
    <div class="modal-body">
      <div class="parent-box">
        <div class="below-header">
          <p>Are you sure, you want to delete consortium member ?</p>
        </div>
        <div class="modal-footer justify-content-center">
          <button
            type="button"
            ngbAutofocus
            class="btn btn-danger red-btn"
            (click)="deleteRecord(deleteId)"
            (click)="modal.close('Ok click')"
          >
            Yes
          </button>
          <button
            type="button"
            class="btn btn-success cancel-btn"
            (click)="modal.dismiss('cancel click')"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #activityLogs let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="modal-basic-title">Activity logs</h5>
      <button *ngIf="closeAble" (click)="hideActivityModel()" class="btn">
        <span aria-label="close">x</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="parent-box">
        <div class="below-header">
          <p>
            Sit back and relax while we delete consortium member for you. We
            will run numerous technical processes in the background which are
            depicted in the following activity logs, so be sure not to exit the
            window as it will impede the thus far progress made.
          </p>
        </div>
        <div class="logs-box">
          <div *ngFor="let logs of logsmsg; let i = index">
            <img
              src="assets/images/icon-images/{{ logs.icon }}"
              (click)="rehitApi(logs.id)"
              alt="loading"
            /><span>{{ logs.msg }}</span>
          </div>
        </div>
        <div class="done-icon-box">
          <div *ngIf="success">
            <p class="install-done">
              Congratulations your consortium member has been deleted
              successfully.
            </p>
            <svg
              id="check-svg"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 130.2 130.2"
            >
              <circle
                class="path circle"
                fill="none"
                stroke="#73ae55"
                stroke-width="6"
                stroke-miterlimit="10"
                cx="65.1"
                cy="65.1"
                r="62.1"
              />
              <polyline
                class="path check"
                fill="none"
                stroke="#73ae55"
                stroke-width="6"
                stroke-linecap="round"
                stroke-miterlimit="10"
                points="100.2,40.2 51.5,88.8 29.8,67.5 "
              />
            </svg>
          </div>
          <div *ngIf="failApi">
            <p class="install-done">
              Unable to delete consortium member, Please try again later.
            </p>
            <svg
              width="90px"
              version="1.1"
              id="cross-svg"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              viewBox="0 0 512 512"
              enable-background="new 0 0 512 512"
              xml:space="preserve"
            >
              <circle
                class="path circle"
                id="cross_circle"
                fill="none"
                stroke="rgb(236, 60, 60)"
                stroke-width="30"
                stroke-miterlimit="10"
                cx="256"
                cy="256"
                r="225"
                fill="transparent"
                stroke-linecap="round"
                stroke-dashoffset="2000"
                stroke-dasharray="2000"
              />
              <g>
                <rect
                  class="path rect-x"
                  id="cross_p1"
                  x="239.397"
                  y="67.518"
                  rx="17"
                  ry="17"
                  transform="matrix(0.7071 0.7071 -0.7071 0.7071 255.9995 -106.0389)"
                  fill="rgb(236, 60, 60)"
                />
              </g>
              <g>
                <rect
                  class="path rect-y"
                  id="cross_p2"
                  x="239.397"
                  y="67.519"
                  rx="17"
                  ry="17"
                  transform="matrix(0.7071 -0.7071 0.7071 0.7071 -106.039 256.0001)"
                  fill="rgb(236, 60, 60)"
                />
              </g>
            </svg>
          </div>
          <div class="install-progress" *ngIf="!success && !failApi">
            <p>Deletion is in progress...</p>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #importDialog let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="modal-basic-title">
        Import Consortium Member
      </h5>
      <button (click)="closeImportModal()" class="btn">
        <span aria-label="close">x</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="parent-box">
        <form>
          <div class="form-group">
            <label for="collection-name">Upload File : </label>
            <div class="inputfile-box">
              <div class="field-outer">
                <input
                  (change)="fileChanged($event)"
                  type="file"
                  class="inputfile"
                  name="file"
                  id="file"
                  accept=".json"
                />
                <label for="file">
                  <span id="file-name" class="file-box">{{ fileName }}</span>
                  <span class="file-button">
                    <i class="fa fa-upload" aria-hidden="true"></i>
                    Select File
                  </span>
                </label>
              </div>
            </div>
            <span *ngIf="noFile" class="error cstm-erorr"
              >Please select a file to import</span
            >
            <span *ngIf="noFileType" class="error cstm-erorr"
              >Please select a valid file to import</span
            >
          </div>

          <div class="text-center mt-5 mb-4">
            <button (click)="uploadDocument()" class="btn save-btn mr-2">
              Import
            </button>
            <button (click)="closeImportModal()" class="btn btn-secondary ml-2">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </ng-template>
</div>
